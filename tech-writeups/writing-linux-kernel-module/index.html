<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anish - Uwriting-linux-kernel-module</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #1e1e2e;
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.05;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .back-link {
            color: #5bc0de;
            text-decoration: none;
            padding: 10px;
            display: block;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .back-link:hover {
            color: #ff6b6b;
            text-shadow: 0 0 5px rgba(255, 107, 107, 0.5);
        }

        .terminal-window {
            background: #2a2a3a;
            border: 2px solid #5bc0de;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 0 15px rgba(91, 192, 222, 0.2);
        }

        .terminal-header {
            background: #3a3a4a;
            padding: 10px;
            border-bottom: 1px solid #5bc0de;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .terminal-dots {
            display: flex;
            gap: 5px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot.red { background: #ff5f56; }
        .dot.yellow { background: #ffbd2e; }
        .dot.green { background: #27ca3f; }

        .terminal-title {
            color: #a0a0a0;
            font-size: 14px;
        }

        .terminal-content {
            padding: 20px;
            padding: 20px 30px;
}

        .terminal-content pre {
            background: #1e1e2e;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .terminal-content code {
            font-family: 'Courier New', monospace;
        }

        .terminal-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .terminal-content th, .terminal-content td {
            border: 1px solid #5bc0de;
            padding: 10px;
            text-align: left;
        }

        .terminal-content th {
            background: #3a3a4a;
            color: #e0e0e0;
        }

        .terminal-content td {
            background: #2a2a3a;
        }

        .prompt {
            color: #5bc0de;
            margin-bottom: 10px;
        }

        .command {
            color: #ff6b6b;
        }

        h1 {
            color: #e0e0e0;
            font-weight: normal;
            text-shadow: 0 0 5px rgba(91, 192, 222, 0.3);
            font-size: 2.2em;
            text-align: center;
            margin-bottom: 20px;
        }

        h2, h3 {
            color: #e0e0e0;
            font-weight: normal;
            margin-bottom: 10px;
        }

        hr {
            border: 0;
            border-top: 1px solid #5bc0de;
            margin: 10px 0 20px 0;
            opacity: 0.5;
        }

        @keyframes glow {
            from { text-shadow: 0 0 5px rgba(91, 192, 222, 0.3); }
            to { text-shadow: 0 0 10px rgba(91, 192, 222, 0.5); }
        }

        .footer {
            text-align: center;
            padding: 20px;
            border-top: 1px solid #5bc0de;
            margin-top: 50px;
            color: #a0a0a0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            
            .terminal-content {
                padding: 15px 20px;
            }

            .terminal-content ol {
                margin-left: 10px;
            }
}
            
            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }

            h2, h3 {
                margin-bottom: 8px;
            }

            hr {
                margin: 8px 0 15px 0;
            }

            .terminal-content table {
                font-size: 0.9em;
            }
        }

        .matrix-char {
            position: absolute;
            color: #5bc0de;
            font-family: monospace;
            font-size: 14px;
            animation: matrix-fall linear infinite;
        }

        @keyframes matrix-fall {
            0% { opacity: 1; transform: translateY(-100vh); }
            100% { opacity: 0; transform: translateY(100vh); }
        }
    
        .terminal-content ol {
            margin-left: 15px;
        }

        .terminal-content ol li {
            margin-bottom: 10px;
        }
</style>
</head>
<body>
    <canvas class="matrix-bg" id="matrixCanvas"></canvas>

    <div class="container">
        <a href="https://anish7600.github.io/tech-writeups" class="back-link">← Back</a>
        
        <h1>Uwriting-linux-kernel-module</h1>
        <hr>

        <div class="terminal-window">
            <div class="terminal-header">
                <div class="terminal-dots">
                    <div class="dot red"></div>
                    <div class="dot yellow"></div>
                    <div class="dot green"></div>
                </div>
                <div class="terminal-title">~/technical-writeups/writing-linux-kernel-module/index.sh</div>
            </div>
            <div class="terminal-content">
                <p><a href="https://anish7600.github.io/technical-writeups" style="text-decoration: none;">← Back</a></p>
<h2>Writing a Kernel Module in C for Linux</h2><hr>
<p>Writing a Linux kernel module allows you to extend or modify the behavior of the Linux kernel without needing to reboot or recompile the kernel itself. Kernel modules can be drivers, filesystems, or other system utilities.</p>
<hr />
<h3>1. <strong>What is a Kernel Module?</strong></h3><hr>
<p>A kernel module is a piece of code that can be loaded into the Linux kernel at runtime using tools like <code>insmod</code> and unloaded using <code>rmmod</code>. It runs in kernel space (as opposed to user space) and has access to internal kernel APIs.</p>
<hr />
<h3>2. <strong>Development Environment Setup</strong></h3><hr>
<p>Install the required tools and headers:</p>
<pre class="codehilite"><code class="language-bash">sudo apt update
sudo apt install build-essential linux-headers-$(uname -r)
</code></pre>

<hr />
<h3>3. <strong>Minimal Kernel Module Code</strong></h3><hr>
<p><strong>Filename</strong>: <code>hello_module.c</code></p>
<pre class="codehilite"><code class="language-c">#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;
#include &lt;linux/init.h&gt;

MODULE_LICENSE(&quot;GPL&quot;);
MODULE_AUTHOR(&quot;Anish&quot;);
MODULE_DESCRIPTION(&quot;A simple Linux kernel module&quot;);
MODULE_VERSION(&quot;1.0&quot;);

static int __init hello_init(void) {
    printk(KERN_INFO &quot;Hello, kernel!\n&quot;);
    return 0;
}

static void __exit hello_exit(void) {
    printk(KERN_INFO &quot;Goodbye, kernel!\n&quot;);
}

module_init(hello_init);
module_exit(hello_exit);
</code></pre>

<hr />
<h3>4. <strong>Writing the Makefile</strong></h3><hr>
<p><strong>Filename</strong>: <code>Makefile</code></p>
<pre class="codehilite"><code class="language-Makefile">obj-m += hello_module.o

all:
    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean
</code></pre>

<hr />
<h3>5. <strong>Building and Running the Module</strong></h3><hr>
<pre class="codehilite"><code class="language-bash">make
sudo insmod hello_module.ko
dmesg | tail  # Should show &quot;Hello, kernel!&quot;
sudo rmmod hello_module
dmesg | tail  # Should show &quot;Goodbye, kernel!&quot;
</code></pre>

<hr />
<h3>6. <strong>Debugging and Logging</strong></h3><hr>
<p>Use <code>dmesg</code> to view kernel logs.
Use <code>printk()</code> for logging—use log levels like <code>KERN_INFO</code>, <code>KERN_WARNING</code>, <code>KERN_ERR</code>.</p>
<hr />
<h3>7. <strong>Safety Considerations</strong></h3><hr>
<ul>
<li>Kernel modules run with high privileges.</li>
<li>A buggy module can crash the entire system.</li>
<li>Always test modules in a VM or sandboxed environment.</li>
</ul>
<hr />
<h3>8. <strong>Advanced Topics</strong></h3><hr>
<ul>
<li>Working with device drivers</li>
<li>Using <code>procfs</code> or <code>sysfs</code> for user-space communication</li>
<li>Handling interrupts</li>
<li>Writing character device drivers</li>
</ul>
<hr />
<h3>9. <strong>Useful Tools</strong></h3><hr>
<ul>
<li><code>insmod</code>, <code>rmmod</code>, <code>modinfo</code>, <code>lsmod</code></li>
<li><code>dmesg</code> for kernel logs</li>
<li><code>gdb</code> with <code>kgdb</code> for kernel debugging (advanced)</li>
</ul>
<hr />
<h3>10. <strong>Conclusion</strong></h3><hr>
<p>Kernel modules are powerful tools for extending kernel capabilities on demand. Learning to write them improves your understanding of how the Linux kernel operates under the hood. Always follow best practices and test thoroughly.</p>
            </div>
        </div>

        <div class="footer">
            <div class="prompt">root@writeup:~$ <span class="command">echo "End of transmission"</span></div>
            <p>&copy; 2025 Anish. All rights reserved.</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Highlight.js
            hljs.highlightAll();

            const canvas = document.getElementById('matrixCanvas');
            if (!canvas) {
                console.error('Canvas element not found');
                return;
            }
            const ctx = canvas.getContext('2d');
            if (!ctx) {
                console.error('Canvas context not available');
                return;
            }

            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()_+-=[]{}|;:,.<>?';
            const charArray = chars.split('');
            const fontSize = 14;
            const columns = Math.floor(canvas.width / fontSize);
            const drops = Array(columns).fill(1);

            function draw() {
                ctx.fillStyle = 'rgba(30, 30, 46, 0.04)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#5bc0de';
                ctx.font = `${fontSize}px monospace`;

                for (let i = 0; i < drops.length; i++) {
                    const text = charArray[Math.floor(Math.random() * charArray.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }

            setInterval(draw, 35);

            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        });
    </script>
</body>
</html>
